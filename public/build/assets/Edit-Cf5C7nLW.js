import{r as N,u as _,j as e,H as z,L as c}from"./app-DkBwWcKh.js";import{A as w}from"./AuthenticatedLayout-CaZwdPDN.js";import{T as u,I as d}from"./TextInput-B79uGSl2.js";import{I as m}from"./InputLabel-D5gubbgR.js";import{P as y}from"./PrimaryButton-DT4dyLsn.js";import{M as k}from"./MoneyInput-CmH8ACxQ.js";import{F}from"./FileUpload-CPagVmhb.js";import{u as C}from"./useTranslation-B_0Yj94K.js";import"./transition-DGBe6p1k.js";function q({expense:a}){const{t:s}=C(),[r,x]=N.useState([]),p=t=>new Date(t).toISOString().split("T")[0],{data:n,setData:l,post:h,processing:j,errors:o}=_({_method:"PATCH",invoice_date:p(a.invoice_date),amount:a.amount.toString(),currency:a.currency,company_name:a.company_name,notes:a.notes||"",status:a.status,attachment:null,delete_attachments:[]}),f=t=>{t.preventDefault(),n.delete_attachments=r,h(route("expenses.update",a.id))},v=t=>{x(i=>i.includes(t)?i.filter(b=>b!==t):[...i,t])},g=t=>t>=1048576?(t/1048576).toFixed(2)+" MB":t>=1024?(t/1024).toFixed(2)+" KB":t+" bytes";return a.attachments.filter(t=>!r.includes(t.id)),e.jsxs(w,{className:"bg-plutz-dark",children:[e.jsx(z,{title:s("expenses.edit_expense")}),e.jsx("div",{className:"max-w-[1200px] mx-auto w-full p-6 pb-0",children:e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h2",{className:"text-2xl font-serif text-plutz-cream",children:s("expenses.edit_expense")}),e.jsx(c,{href:route("expenses.show",a.id),className:"text-plutz-tan hover:text-plutz-tan-light text-sm font-medium",children:s("expenses.back_to_details")})]})}),e.jsx("div",{className:"max-w-[1200px] mx-auto w-full p-6",children:e.jsx("div",{className:"overflow-hidden bg-plutz-surface shadow-sm sm:rounded-lg",children:e.jsxs("form",{onSubmit:f,className:"space-y-6 p-6",children:[e.jsxs("div",{className:"border-b border-plutz-tan/10 pb-6",children:[e.jsx("h3",{className:"text-lg font-medium text-plutz-cream",children:s("expenses.invoice_details")}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(m,{htmlFor:"invoice_date",value:s("expenses.invoice_date_field")}),e.jsx(u,{id:"invoice_date",type:"date",className:"mt-1 block w-full",value:n.invoice_date,onChange:t=>l("invoice_date",t.target.value),required:!0}),e.jsx(d,{message:o.invoice_date,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"company_name",value:s("expenses.company_name")}),e.jsx(u,{id:"company_name",type:"text",className:"mt-1 block w-full",value:n.company_name,onChange:t=>l("company_name",t.target.value),required:!0}),e.jsx(d,{message:o.company_name,className:"mt-2"})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx(k,{label:s("common.amount"),value:n.amount,onChange:t=>l("amount",t),currency:n.currency,error:o.amount,required:!0})}),e.jsxs("div",{className:"mt-4",children:[e.jsx(m,{htmlFor:"status",value:s("common.status")}),e.jsxs("select",{id:"status",className:"mt-1 block w-full rounded-md border-plutz-tan/20 shadow-sm focus:border-plutz-tan focus:ring-plutz-tan",value:n.status,onChange:t=>l("status",t.target.value),children:[e.jsx("option",{value:"paid",children:s("expenses.status_paid")}),e.jsx("option",{value:"unpaid",children:s("expenses.status_unpaid")})]}),e.jsx(d,{message:o.status,className:"mt-2"})]})]}),a.attachments.length>0&&e.jsxs("div",{className:"border-b border-plutz-tan/10 pb-6",children:[e.jsx("h3",{className:"text-lg font-medium text-plutz-cream",children:s("expenses.current_attachments")}),e.jsx("p",{className:"mt-1 text-sm text-stone-400",children:s("expenses.mark_for_deletion")}),e.jsx("div",{className:"mt-4 space-y-3",children:a.attachments.map(t=>e.jsxs("div",{className:`flex items-center justify-between rounded-lg border p-4 ${r.includes(t.id)?"border-red-500/20 bg-red-500/10":"border-plutz-tan/10"}`,children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{className:"h-8 w-8 text-stone-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:`text-sm font-medium ${r.includes(t.id)?"text-red-400 line-through":"text-plutz-cream"}`,children:t.original_name}),e.jsx("p",{className:"text-sm text-stone-500",children:g(t.size)})]})]}),e.jsx("button",{type:"button",onClick:()=>v(t.id),className:`rounded-md px-3 py-2 text-sm font-semibold ${r.includes(t.id)?"bg-plutz-tan/20 text-stone-400 hover:bg-plutz-tan/30":"bg-red-500/10 text-red-400 hover:bg-red-500/20"}`,children:r.includes(t.id)?s("expenses.keep"):s("common.delete")})]},t.id))})]}),e.jsxs("div",{className:"border-b border-plutz-tan/10 pb-6",children:[e.jsx("h3",{className:"text-lg font-medium text-plutz-cream",children:s("expenses.new_attachment")}),e.jsx("p",{className:"mt-1 text-sm text-stone-400",children:s("expenses.attachment_hint")}),e.jsx("div",{className:"mt-4",children:e.jsx(F,{accept:"image/*,application/pdf",onChange:t=>l("attachment",t),error:o.attachment,capture:!0})})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"notes",value:s("common.notes")}),e.jsx("textarea",{id:"notes",className:"mt-1 block w-full rounded-md border-plutz-tan/20 shadow-sm focus:border-plutz-tan focus:ring-plutz-tan",rows:4,value:n.notes,onChange:t=>l("notes",t.target.value)}),e.jsx(d,{message:o.notes,className:"mt-2"})]}),e.jsxs("div",{className:"flex items-center justify-end gap-4",children:[e.jsx(c,{href:route("expenses.show",a.id),className:"text-sm text-stone-400 hover:text-plutz-cream",children:s("common.cancel")}),e.jsx(y,{disabled:j,children:s("expenses.update_expense")})]})]})})})]})}export{q as default};
