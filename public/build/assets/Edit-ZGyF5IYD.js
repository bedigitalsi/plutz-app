import{r as y,u as N,j as e,H as b,L as c}from"./app-DzmAS_oz.js";import{A as _}from"./AuthenticatedLayout-iZAWnfa0.js";import{T as m,I as d}from"./TextInput-C94tWs1r.js";import{I as l}from"./InputLabel-Bokvtw8l.js";import{P as w}from"./PrimaryButton-DYn3vejL.js";import{M as k}from"./MoneyInput-CYJW-hJp.js";import{F as C}from"./FileUpload-BTu1Awbq.js";import"./transition-Bd1tV77w.js";function B({expense:s}){const[r,u]=y.useState([]),x=t=>new Date(t).toISOString().split("T")[0],{data:a,setData:i,post:h,processing:g,errors:n}=N({_method:"PATCH",invoice_date:x(s.invoice_date),amount:s.amount.toString(),currency:s.currency,company_name:s.company_name,notes:s.notes||"",status:s.status,attachment:null,delete_attachments:[]}),p=t=>{t.preventDefault(),a.delete_attachments=r,h(route("expenses.update",s.id))},j=t=>{u(o=>o.includes(t)?o.filter(f=>f!==t):[...o,t])},v=t=>t>=1048576?(t/1048576).toFixed(2)+" MB":t>=1024?(t/1024).toFixed(2)+" KB":t+" bytes";return s.attachments.filter(t=>!r.includes(t.id)),e.jsxs(_,{header:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800",children:"Edit Expense"}),e.jsx(c,{href:route("expenses.show",s.id),className:"text-sm text-gray-600 hover:text-gray-900",children:"â† Back to Details"})]}),children:[e.jsx(b,{title:"Edit Expense"}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"mx-auto max-w-3xl sm:px-6 lg:px-8",children:e.jsx("div",{className:"overflow-hidden bg-white shadow-sm sm:rounded-lg",children:e.jsxs("form",{onSubmit:p,className:"space-y-6 p-6",children:[e.jsxs("div",{className:"border-b border-gray-200 pb-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Invoice Details"}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"invoice_date",value:"Invoice Date *"}),e.jsx(m,{id:"invoice_date",type:"date",className:"mt-1 block w-full",value:a.invoice_date,onChange:t=>i("invoice_date",t.target.value),required:!0}),e.jsx(d,{message:n.invoice_date,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"company_name",value:"Company Name *"}),e.jsx(m,{id:"company_name",type:"text",className:"mt-1 block w-full",value:a.company_name,onChange:t=>i("company_name",t.target.value),required:!0}),e.jsx(d,{message:n.company_name,className:"mt-2"})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx(k,{label:"Amount",value:a.amount,onChange:t=>i("amount",t),currency:a.currency,error:n.amount,required:!0})}),e.jsxs("div",{className:"mt-4",children:[e.jsx(l,{htmlFor:"status",value:"Status"}),e.jsxs("select",{id:"status",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",value:a.status,onChange:t=>i("status",t.target.value),children:[e.jsx("option",{value:"paid",children:"Paid"}),e.jsx("option",{value:"unpaid",children:"Unpaid"})]}),e.jsx(d,{message:n.status,className:"mt-2"})]})]}),s.attachments.length>0&&e.jsxs("div",{className:"border-b border-gray-200 pb-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Current Attachments"}),e.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Click to mark attachments for deletion"}),e.jsx("div",{className:"mt-4 space-y-3",children:s.attachments.map(t=>e.jsxs("div",{className:`flex items-center justify-between rounded-lg border p-4 ${r.includes(t.id)?"border-red-300 bg-red-50":"border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{className:"h-8 w-8 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:`text-sm font-medium ${r.includes(t.id)?"text-red-600 line-through":"text-gray-900"}`,children:t.original_name}),e.jsx("p",{className:"text-sm text-gray-500",children:v(t.size)})]})]}),e.jsx("button",{type:"button",onClick:()=>j(t.id),className:`rounded-md px-3 py-2 text-sm font-semibold ${r.includes(t.id)?"bg-gray-200 text-gray-700 hover:bg-gray-300":"bg-red-100 text-red-700 hover:bg-red-200"}`,children:r.includes(t.id)?"Keep":"Delete"})]},t.id))})]}),e.jsxs("div",{className:"border-b border-gray-200 pb-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Add New Attachment"}),e.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Upload a photo or PDF of the invoice"}),e.jsx("div",{className:"mt-4",children:e.jsx(C,{accept:"image/*,application/pdf",onChange:t=>i("attachment",t),error:n.attachment,capture:!0})})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"notes",value:"Notes"}),e.jsx("textarea",{id:"notes",className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500",rows:4,value:a.notes,onChange:t=>i("notes",t.target.value)}),e.jsx(d,{message:n.notes,className:"mt-2"})]}),e.jsxs("div",{className:"flex items-center justify-end gap-4",children:[e.jsx(c,{href:route("expenses.show",s.id),className:"text-sm text-gray-600 hover:text-gray-900",children:"Cancel"}),e.jsx(w,{disabled:g,children:"Update Expense"})]})]})})})})]})}export{B as default};
