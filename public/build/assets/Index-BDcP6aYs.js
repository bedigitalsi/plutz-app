import{c as C,r as t,u as k,j as e,H as T,b as F}from"./app-DUWWFM7U.js";import{A as S}from"./AuthenticatedLayout-B5rftq84.js";import{T as L,I as D}from"./TextInput-BQk72gJh.js";import{I}from"./InputLabel-CUhCXr2k.js";import{P as R}from"./PrimaryButton-EX51XvXj.js";import"./transition-DTPBxna8.js";function H({feeds:o,baseUrl:d}){const{flash:l}=C().props,[i,a]=t.useState(!1),[c,n]=t.useState(!1),[r,x]=t.useState(""),[h,m]=t.useState(!1),{data:u,setData:p,post:f,processing:g,errors:b,reset:j}=k({name:""});t.useEffect(()=>{l?.plainToken&&(x(l.plainToken),n(!0))},[l]);const y=s=>{s.preventDefault(),f(route("ical-feeds.store"),{onSuccess:()=>{j(),a(!1)}})},v=s=>{confirm("Are you sure you want to delete this feed? The subscription URL will stop working.")&&F.delete(route("ical-feeds.destroy",s))},N=s=>{navigator.clipboard.writeText(s).then(()=>{m(!0),setTimeout(()=>m(!1),2e3)})},w=s=>new Date(s).toLocaleDateString("sl-SI",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});return e.jsxs(S,{header:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold leading-tight text-gray-800",children:"iCal Feeds"}),e.jsx("button",{onClick:()=>a(!i),className:"rounded-md bg-indigo-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500",children:i?"Cancel":"New Feed"})]}),children:[e.jsx(T,{title:"iCal Feeds"}),e.jsx("div",{className:"py-12",children:e.jsxs("div",{className:"mx-auto max-w-4xl sm:px-6 lg:px-8",children:[e.jsx("div",{className:"mb-6 rounded-lg bg-blue-50 p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-blue-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-blue-800",children:"About iCal Feeds"}),e.jsx("div",{className:"mt-2 text-sm text-blue-700",children:e.jsx("p",{children:"Create feeds to subscribe to your confirmed inquiries in Apple Calendar or other calendar apps. Each feed generates a unique URL that you can copy and use in your calendar app."})})]})]})}),i&&e.jsx("div",{className:"mb-6 overflow-hidden rounded-lg bg-white shadow-sm",children:e.jsxs("form",{onSubmit:y,className:"p-6",children:[e.jsxs("div",{children:[e.jsx(I,{htmlFor:"name",value:"Feed Name *"}),e.jsx(L,{id:"name",type:"text",className:"mt-1 block w-full",value:u.name,onChange:s=>p("name",s.target.value),placeholder:"e.g. My Calendar",required:!0,autoFocus:!0}),e.jsx(D,{message:b.name,className:"mt-2"})]}),e.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:()=>a(!1),className:"rounded-md bg-gray-200 px-4 py-2 text-sm font-semibold text-gray-700 hover:bg-gray-300",children:"Cancel"}),e.jsx(R,{disabled:g,children:"Create Feed"})]})]})}),c&&r&&e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex min-h-screen items-center justify-center px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 transition-opacity",onClick:()=>n(!1),children:e.jsx("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),e.jsxs("div",{className:"inline-block transform overflow-hidden rounded-lg bg-white text-left align-bottom shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg sm:align-middle",children:[e.jsx("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:e.jsxs("div",{className:"sm:flex sm:items-start",children:[e.jsx("div",{className:"mx-auto flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full bg-green-100 sm:mx-0 sm:h-10 sm:w-10",children:e.jsx("svg",{className:"h-6 w-6 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsxs("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left",children:[e.jsx("h3",{className:"text-lg font-medium leading-6 text-gray-900",children:"Feed Created Successfully!"}),e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-sm text-gray-500 mb-2",children:"Copy this URL to subscribe in your calendar app. This token will only be shown once!"}),e.jsx("div",{className:"mt-2 rounded-md bg-gray-100 p-3",children:e.jsxs("code",{className:"text-xs break-all",children:[d,"/",r,".ics"]})}),e.jsx("button",{onClick:()=>N(`${d}/${r}.ics`),className:"mt-3 w-full rounded-md bg-indigo-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500",children:h?"âœ“ Copied!":"Copy URL"})]})]})]})}),e.jsx("div",{className:"bg-gray-50 px-4 py-3 sm:flex sm:flex-row-reverse sm:px-6",children:e.jsx("button",{onClick:()=>n(!1),className:"inline-flex w-full justify-center rounded-md border border-transparent bg-gray-600 px-4 py-2 text-base font-medium text-white shadow-sm hover:bg-gray-700 focus:outline-none sm:ml-3 sm:w-auto sm:text-sm",children:"Close"})})]})]})}),o.length===0?e.jsxs("div",{className:"rounded-lg bg-white p-8 text-center shadow-sm",children:[e.jsx("p",{className:"text-gray-500",children:"No feeds created yet."}),e.jsx("button",{onClick:()=>a(!0),className:"mt-4 inline-block text-indigo-600 hover:text-indigo-500",children:"Create your first feed"})]}):e.jsx("div",{className:"space-y-4",children:o.map(s=>e.jsx("div",{className:"overflow-hidden rounded-lg bg-white shadow-sm",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:s.name}),e.jsxs("p",{className:"mt-1 text-sm text-gray-600",children:["Created by ",s.creator.name," on ",w(s.created_at)]}),e.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"This feed shows all confirmed inquiries."})]}),e.jsx("button",{onClick:()=>v(s.id),className:"ml-4 rounded-md bg-red-600 px-3 py-1 text-sm font-semibold text-white shadow-sm hover:bg-red-500",children:"Delete"})]})})},s.id))})]})})]})}export{H as default};
