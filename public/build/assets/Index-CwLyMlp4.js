import{a as z,r as a,u as C,j as e,H as T,b as _}from"./app-C4sHziNE.js";import{A as S}from"./AuthenticatedLayout-DCqWRLfr.js";import{T as I,I as D}from"./TextInput--s-1SGec.js";import{I as F}from"./InputLabel-D48HTLk4.js";import{P as L}from"./PrimaryButton-o_evbg6d.js";import{u as M}from"./useTranslation-B0ntzVMZ.js";import"./transition-BXWP2Hev.js";function q({feeds:o,baseUrl:c}){const{t:s}=M(),{flash:l}=z().props,[d,n]=a.useState(!1),[x,i]=a.useState(!1),[r,u]=a.useState(""),[h,m]=a.useState(!1),{data:p,setData:f,post:j,processing:b,errors:v,reset:g}=C({name:""});a.useEffect(()=>{l?.plainToken&&(u(l.plainToken),i(!0))},[l]);const N=t=>{t.preventDefault(),j(route("ical-feeds.store"),{onSuccess:()=>{g(),n(!1)}})},w=t=>{confirm(s("ical.confirm_delete"))&&_.delete(route("ical-feeds.destroy",t))},k=t=>{navigator.clipboard.writeText(t).then(()=>{m(!0),setTimeout(()=>m(!1),2e3)})},y=t=>new Date(t).toLocaleDateString("sl-SI",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});return e.jsxs(S,{className:"bg-plutz-dark",children:[e.jsx(T,{title:s("ical.title")}),e.jsx("div",{className:"max-w-[1200px] mx-auto w-full p-6 pb-0",children:e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx("h2",{className:"text-2xl font-serif text-plutz-cream",children:s("ical.title")})})}),e.jsxs("div",{className:"max-w-[1200px] mx-auto w-full p-6",children:[e.jsx("div",{className:"mb-6 rounded-lg bg-plutz-tan/10 p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-blue-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-plutz-tan",children:s("ical.about_title")}),e.jsx("div",{className:"mt-2 text-sm text-plutz-tan",children:e.jsx("p",{children:s("ical.about_description")})})]})]})}),d&&e.jsx("div",{className:"mb-6 overflow-hidden rounded-lg bg-plutz-surface shadow-sm",children:e.jsxs("form",{onSubmit:N,className:"p-6",children:[e.jsxs("div",{children:[e.jsx(F,{htmlFor:"name",value:s("ical.feed_name")}),e.jsx(I,{id:"name",type:"text",className:"mt-1 block w-full",value:p.name,onChange:t=>f("name",t.target.value),placeholder:s("ical.feed_placeholder"),required:!0,autoFocus:!0}),e.jsx(D,{message:v.name,className:"mt-2"})]}),e.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:()=>n(!1),className:"rounded-md bg-plutz-tan/20 px-4 py-2 text-sm font-semibold text-stone-400 hover:bg-plutz-tan/30",children:s("common.cancel")}),e.jsx(L,{disabled:b,children:s("ical.create_feed")})]})]})}),x&&r&&e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex min-h-screen items-center justify-center px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 transition-opacity",onClick:()=>i(!1),children:e.jsx("div",{className:"absolute inset-0 bg-stone-900/500 opacity-75"})}),e.jsxs("div",{className:"inline-block transform overflow-hidden rounded-lg bg-plutz-surface text-left align-bottom shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg sm:align-middle",children:[e.jsx("div",{className:"bg-plutz-surface px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:e.jsxs("div",{className:"sm:flex sm:items-start",children:[e.jsx("div",{className:"mx-auto flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full bg-green-500/100/10 sm:mx-0 sm:h-10 sm:w-10",children:e.jsx("svg",{className:"h-6 w-6 text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsxs("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left",children:[e.jsx("h3",{className:"text-lg font-medium leading-6 text-plutz-cream",children:s("ical.success_title")}),e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-sm text-stone-500 mb-2",children:s("ical.success_message")}),e.jsx("div",{className:"mt-2 rounded-md bg-stone-800 p-3",children:e.jsxs("code",{className:"text-xs break-all",children:[c,"/",r,".ics"]})}),e.jsx("button",{onClick:()=>k(`${c}/${r}.ics`),className:"mt-3 w-full rounded-md bg-plutz-tan px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-plutz-tan/90",children:s(h?"ical.copied":"ical.copy_url")})]})]})]})}),e.jsx("div",{className:"bg-stone-900/50 px-4 py-3 sm:flex sm:flex-row-reverse sm:px-6",children:e.jsx("button",{onClick:()=>i(!1),className:"inline-flex w-full justify-center rounded-md border border-transparent bg-stone-700 px-4 py-2 text-base font-medium text-white shadow-sm hover:bg-stone-700 focus:outline-none sm:ml-3 sm:w-auto sm:text-sm",children:s("ical.close")})})]})]})}),o.length===0?e.jsxs("div",{className:"rounded-lg bg-plutz-surface p-8 text-center shadow-sm",children:[e.jsx("p",{className:"text-stone-500",children:s("ical.no_feeds")}),e.jsx("button",{onClick:()=>n(!0),className:"mt-4 inline-block text-plutz-tan hover:text-plutz-tan",children:s("ical.create_first")})]}):e.jsx("div",{className:"space-y-4",children:o.map(t=>e.jsx("div",{className:"overflow-hidden rounded-lg bg-plutz-surface shadow-sm",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-plutz-cream",children:t.name}),e.jsxs("p",{className:"mt-1 text-sm text-stone-400",children:["Created by ",t.creator.name," on ",y(t.created_at)]}),e.jsx("p",{className:"mt-2 text-xs text-stone-500",children:s("ical.feed_info")})]}),e.jsx("button",{onClick:()=>w(t.id),className:"ml-4 rounded-md bg-red-600 px-3 py-1 text-sm font-semibold text-white shadow-sm hover:bg-red-500/100",children:s("common.delete")})]})})},t.id))})]})]})}export{q as default};
