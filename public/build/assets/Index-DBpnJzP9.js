import{c as k,r as t,u as C,j as e,H as z,b as T}from"./app-BJc9Tm1D.js";import{A as F}from"./AuthenticatedLayout-DtotMtSK.js";import{T as S,I as L}from"./TextInput-C74EyNtM.js";import{I as D}from"./InputLabel-GFiCJOTr.js";import{P as I}from"./PrimaryButton-RZKOhaPJ.js";import"./transition-9_ymNAk6.js";function H({feeds:i,baseUrl:o}){const{flash:a}=k().props,[c,l]=t.useState(!1),[m,n]=t.useState(!1),[r,x]=t.useState(""),[u,d]=t.useState(!1),{data:h,setData:p,post:f,processing:b,errors:j,reset:v}=C({name:""});t.useEffect(()=>{a?.plainToken&&(x(a.plainToken),n(!0))},[a]);const g=s=>{s.preventDefault(),f(route("ical-feeds.store"),{onSuccess:()=>{v(),l(!1)}})},N=s=>{confirm("Are you sure you want to delete this feed? The subscription URL will stop working.")&&T.delete(route("ical-feeds.destroy",s))},w=s=>{navigator.clipboard.writeText(s).then(()=>{d(!0),setTimeout(()=>d(!1),2e3)})},y=s=>new Date(s).toLocaleDateString("sl-SI",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});return e.jsxs(F,{className:"bg-plutz-dark",children:[e.jsx(z,{title:"iCal Feeds"}),e.jsx("div",{className:"max-w-[1200px] mx-auto w-full p-6 pb-0",children:e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx("h2",{className:"text-2xl font-serif text-plutz-cream",children:"iCal Feeds"})})}),e.jsxs("div",{className:"max-w-[1200px] mx-auto w-full p-6",children:[e.jsx("div",{className:"mb-6 rounded-lg bg-plutz-tan/10 p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-blue-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-plutz-tan",children:"About iCal Feeds"}),e.jsx("div",{className:"mt-2 text-sm text-plutz-tan",children:e.jsx("p",{children:"Create feeds to subscribe to your confirmed inquiries in Apple Calendar or other calendar apps. Each feed generates a unique URL that you can copy and use in your calendar app."})})]})]})}),c&&e.jsx("div",{className:"mb-6 overflow-hidden rounded-lg bg-plutz-surface shadow-sm",children:e.jsxs("form",{onSubmit:g,className:"p-6",children:[e.jsxs("div",{children:[e.jsx(D,{htmlFor:"name",value:"Feed Name *"}),e.jsx(S,{id:"name",type:"text",className:"mt-1 block w-full",value:h.name,onChange:s=>p("name",s.target.value),placeholder:"e.g. My Calendar",required:!0,autoFocus:!0}),e.jsx(L,{message:j.name,className:"mt-2"})]}),e.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:()=>l(!1),className:"rounded-md bg-plutz-tan/20 px-4 py-2 text-sm font-semibold text-stone-400 hover:bg-plutz-tan/30",children:"Cancel"}),e.jsx(I,{disabled:b,children:"Create Feed"})]})]})}),m&&r&&e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex min-h-screen items-center justify-center px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 transition-opacity",onClick:()=>n(!1),children:e.jsx("div",{className:"absolute inset-0 bg-stone-900/500 opacity-75"})}),e.jsxs("div",{className:"inline-block transform overflow-hidden rounded-lg bg-plutz-surface text-left align-bottom shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg sm:align-middle",children:[e.jsx("div",{className:"bg-plutz-surface px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:e.jsxs("div",{className:"sm:flex sm:items-start",children:[e.jsx("div",{className:"mx-auto flex h-12 w-12 flex-shrink-0 items-center justify-center rounded-full bg-green-500/100/10 sm:mx-0 sm:h-10 sm:w-10",children:e.jsx("svg",{className:"h-6 w-6 text-green-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsxs("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left",children:[e.jsx("h3",{className:"text-lg font-medium leading-6 text-plutz-cream",children:"Feed Created Successfully!"}),e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-sm text-stone-500 mb-2",children:"Copy this URL to subscribe in your calendar app. This token will only be shown once!"}),e.jsx("div",{className:"mt-2 rounded-md bg-stone-800 p-3",children:e.jsxs("code",{className:"text-xs break-all",children:[o,"/",r,".ics"]})}),e.jsx("button",{onClick:()=>w(`${o}/${r}.ics`),className:"mt-3 w-full rounded-md bg-plutz-tan px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-plutz-tan/90",children:u?"âœ“ Copied!":"Copy URL"})]})]})]})}),e.jsx("div",{className:"bg-stone-900/50 px-4 py-3 sm:flex sm:flex-row-reverse sm:px-6",children:e.jsx("button",{onClick:()=>n(!1),className:"inline-flex w-full justify-center rounded-md border border-transparent bg-stone-700 px-4 py-2 text-base font-medium text-white shadow-sm hover:bg-stone-700 focus:outline-none sm:ml-3 sm:w-auto sm:text-sm",children:"Close"})})]})]})}),i.length===0?e.jsxs("div",{className:"rounded-lg bg-plutz-surface p-8 text-center shadow-sm",children:[e.jsx("p",{className:"text-stone-500",children:"No feeds created yet."}),e.jsx("button",{onClick:()=>l(!0),className:"mt-4 inline-block text-plutz-tan hover:text-plutz-tan",children:"Create your first feed"})]}):e.jsx("div",{className:"space-y-4",children:i.map(s=>e.jsx("div",{className:"overflow-hidden rounded-lg bg-plutz-surface shadow-sm",children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-plutz-cream",children:s.name}),e.jsxs("p",{className:"mt-1 text-sm text-stone-400",children:["Created by ",s.creator.name," on ",y(s.created_at)]}),e.jsx("p",{className:"mt-2 text-xs text-stone-500",children:"This feed shows all confirmed inquiries."})]}),e.jsx("button",{onClick:()=>N(s.id),className:"ml-4 rounded-md bg-red-600 px-3 py-1 text-sm font-semibold text-white shadow-sm hover:bg-red-500/100",children:"Delete"})]})})},s.id))})]})]})}export{H as default};
