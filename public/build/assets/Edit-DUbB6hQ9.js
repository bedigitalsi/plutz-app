import{r as N,u as b,j as e,H as z,L as m}from"./app-BJc9Tm1D.js";import{A as w}from"./AuthenticatedLayout-DtotMtSK.js";import{T as c,I as i}from"./TextInput-C74EyNtM.js";import{I as d}from"./InputLabel-GFiCJOTr.js";import{P as y}from"./PrimaryButton-RZKOhaPJ.js";import{M as _}from"./MoneyInput-DKvoBFc5.js";import{F as k}from"./FileUpload-Cb_BjFTg.js";import"./transition-9_ymNAk6.js";function T({expense:s}){const[r,u]=N.useState([]),x=t=>new Date(t).toISOString().split("T")[0],{data:a,setData:l,post:p,processing:h,errors:n}=b({_method:"PATCH",invoice_date:x(s.invoice_date),amount:s.amount.toString(),currency:s.currency,company_name:s.company_name,notes:s.notes||"",status:s.status,attachment:null,delete_attachments:[]}),j=t=>{t.preventDefault(),a.delete_attachments=r,p(route("expenses.update",s.id))},f=t=>{u(o=>o.includes(t)?o.filter(g=>g!==t):[...o,t])},v=t=>t>=1048576?(t/1048576).toFixed(2)+" MB":t>=1024?(t/1024).toFixed(2)+" KB":t+" bytes";return s.attachments.filter(t=>!r.includes(t.id)),e.jsxs(w,{className:"bg-plutz-dark",children:[e.jsx(z,{title:"Edit Expense"}),e.jsx("div",{className:"max-w-[1200px] mx-auto w-full p-6 pb-0",children:e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h2",{className:"text-2xl font-serif text-plutz-cream",children:"Edit Expense"}),e.jsx(m,{href:route("expenses.show",s.id),className:"text-plutz-tan hover:text-plutz-tan-light text-sm font-medium",children:"Back to Details"})]})}),e.jsx("div",{className:"max-w-[1200px] mx-auto w-full p-6",children:e.jsx("div",{className:"overflow-hidden bg-plutz-surface shadow-sm sm:rounded-lg",children:e.jsxs("form",{onSubmit:j,className:"space-y-6 p-6",children:[e.jsxs("div",{className:"border-b border-plutz-tan/10 pb-6",children:[e.jsx("h3",{className:"text-lg font-medium text-plutz-cream",children:"Invoice Details"}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(d,{htmlFor:"invoice_date",value:"Invoice Date *"}),e.jsx(c,{id:"invoice_date",type:"date",className:"mt-1 block w-full",value:a.invoice_date,onChange:t=>l("invoice_date",t.target.value),required:!0}),e.jsx(i,{message:n.invoice_date,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"company_name",value:"Company Name *"}),e.jsx(c,{id:"company_name",type:"text",className:"mt-1 block w-full",value:a.company_name,onChange:t=>l("company_name",t.target.value),required:!0}),e.jsx(i,{message:n.company_name,className:"mt-2"})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx(_,{label:"Amount",value:a.amount,onChange:t=>l("amount",t),currency:a.currency,error:n.amount,required:!0})}),e.jsxs("div",{className:"mt-4",children:[e.jsx(d,{htmlFor:"status",value:"Status"}),e.jsxs("select",{id:"status",className:"mt-1 block w-full rounded-md border-plutz-tan/20 shadow-sm focus:border-plutz-tan focus:ring-plutz-tan",value:a.status,onChange:t=>l("status",t.target.value),children:[e.jsx("option",{value:"paid",children:"Paid"}),e.jsx("option",{value:"unpaid",children:"Unpaid"})]}),e.jsx(i,{message:n.status,className:"mt-2"})]})]}),s.attachments.length>0&&e.jsxs("div",{className:"border-b border-plutz-tan/10 pb-6",children:[e.jsx("h3",{className:"text-lg font-medium text-plutz-cream",children:"Current Attachments"}),e.jsx("p",{className:"mt-1 text-sm text-stone-400",children:"Click to mark attachments for deletion"}),e.jsx("div",{className:"mt-4 space-y-3",children:s.attachments.map(t=>e.jsxs("div",{className:`flex items-center justify-between rounded-lg border p-4 ${r.includes(t.id)?"border-red-500/20 bg-red-500/10":"border-plutz-tan/10"}`,children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("svg",{className:"h-8 w-8 text-stone-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:`text-sm font-medium ${r.includes(t.id)?"text-red-400 line-through":"text-plutz-cream"}`,children:t.original_name}),e.jsx("p",{className:"text-sm text-stone-500",children:v(t.size)})]})]}),e.jsx("button",{type:"button",onClick:()=>f(t.id),className:`rounded-md px-3 py-2 text-sm font-semibold ${r.includes(t.id)?"bg-plutz-tan/20 text-stone-400 hover:bg-plutz-tan/30":"bg-red-500/10 text-red-400 hover:bg-red-500/20"}`,children:r.includes(t.id)?"Keep":"Delete"})]},t.id))})]}),e.jsxs("div",{className:"border-b border-plutz-tan/10 pb-6",children:[e.jsx("h3",{className:"text-lg font-medium text-plutz-cream",children:"Add New Attachment"}),e.jsx("p",{className:"mt-1 text-sm text-stone-400",children:"Upload a photo or PDF of the invoice"}),e.jsx("div",{className:"mt-4",children:e.jsx(k,{accept:"image/*,application/pdf",onChange:t=>l("attachment",t),error:n.attachment,capture:!0})})]}),e.jsxs("div",{children:[e.jsx(d,{htmlFor:"notes",value:"Notes"}),e.jsx("textarea",{id:"notes",className:"mt-1 block w-full rounded-md border-plutz-tan/20 shadow-sm focus:border-plutz-tan focus:ring-plutz-tan",rows:4,value:a.notes,onChange:t=>l("notes",t.target.value)}),e.jsx(i,{message:n.notes,className:"mt-2"})]}),e.jsxs("div",{className:"flex items-center justify-end gap-4",children:[e.jsx(m,{href:route("expenses.show",s.id),className:"text-sm text-stone-400 hover:text-plutz-cream",children:"Cancel"}),e.jsx(y,{disabled:h,children:"Update Expense"})]})]})})})]})}export{T as default};
